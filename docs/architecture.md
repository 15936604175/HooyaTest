# Vue3 + Flask 登录与图片展示系统技术架构

## 一、项目概述

本项目是一个基于 Vue 3 和 Flask 的前后端分离系统，实现了用户登录认证和图片上传、展示、删除功能。系统采用 JWT 进行身份验证，使用 MySQL 数据库存储用户和图片信息。

## 二、技术栈

### 1. 前端技术栈
- **Vue 3**：使用 Composition API 进行组件开发
- **Vue Router 4**：实现前端路由管理
- **Pinia**：实现状态管理
- **Axios**：处理 HTTP 请求
- **Element Plus**：提供 UI 组件库

### 2. 后端技术栈
- **Flask 2.0+**：Web 应用框架
- **Flask-CORS**：处理跨域请求
- **Flask-SQLAlchemy**：ORM 数据库操作
- **PyMySQL**：MySQL 数据库驱动
- **PyJWT**：JWT 认证
- **python-dotenv**：环境变量管理

### 3. 数据库
- **MySQL 8.0+**：关系型数据库

## 三、系统架构

### 1. 整体架构

```
┌─────────────────┐       ┌─────────────────┐       ┌─────────────────┐
│   前端应用       │       │   后端 API       │       │   数据库        │
│  (Vue 3)        │──────►│  (Flask)        │──────►│  (MySQL)        │
│                 │◄──────│                 │◄──────│                 │
└─────────────────┘       └─────────────────┘       └─────────────────┘
```

### 2. 前端架构

前端采用组件化开发，主要包含以下模块：

- **路由管理**：使用 Vue Router 管理页面路由，包括登录页和图片展示页
- **状态管理**：使用 Pinia 管理全局状态
- **HTTP 请求**：使用 Axios 发送请求，并配置拦截器处理认证
- **UI 组件**：使用 Element Plus 构建用户界面

### 3. 后端架构

后端采用 Flask 蓝图（Blueprint）组织代码，主要包含以下模块：

- **应用初始化**：创建 Flask 应用实例，配置数据库和 CORS
- **认证模块**：处理用户注册、登录、登出和 token 刷新
- **图片管理模块**：处理图片上传、查询和删除
- **数据库模型**：定义用户和图片数据模型

### 4. 数据库架构

数据库包含两个主要表：

- **users 表**：存储用户信息，包括用户名和密码哈希
- **images 表**：存储图片信息，包括文件名、路径和所属用户

## 四、核心流程

### 1. 用户登录流程

1. 用户在前端输入用户名和密码
2. 前端发送 POST 请求到 `/api/login`
3. 后端验证用户名和密码
4. 验证成功后生成 JWT token 返回给前端
5. 前端将 token 存储到本地存储
6. 前端使用 token 访问受保护的资源

### 2. 图片上传流程

1. 用户登录后进入图片展示页
2. 点击上传按钮，选择图片文件
3. 前端发送带有 token 的 POST 请求到 `/api/images/upload`
4. 后端验证 token
5. 验证成功后保存图片文件
6. 在数据库中记录图片信息
7. 返回上传成功的响应

### 3. 图片展示流程

1. 用户登录后进入图片展示页
2. 前端发送带有 token 的 GET 请求到 `/api/images`
3. 后端验证 token
4. 查询该用户的所有图片
5. 返回图片列表给前端
6. 前端渲染图片列表

## 五、安全性设计

1. **密码安全**：使用 bcrypt 算法对密码进行哈希存储
2. **身份验证**：使用 JWT 进行无状态身份验证
3. **授权控制**：每个 API 都验证用户身份，确保用户只能访问自己的资源
4. **跨域保护**：使用 Flask-CORS 配置跨域访问
5. **文件安全**：限制上传文件类型，使用安全文件名

## 六、性能优化

1. **前端优化**：
   - 使用 Vue 3 的 Composition API 提高性能
   - 组件懒加载
   - 图片懒加载

2. **后端优化**：
   - 关闭 SQLAlchemy 的修改跟踪，提高数据库操作性能
   - 使用索引优化数据库查询
   - 合理设置 JWT 过期时间

3. **数据库优化**：
   - 合理设计表结构和关系
   - 使用索引提高查询效率

## 七、部署建议

1. **开发环境**：
   - 前端：使用 Vue CLI 开发服务器
   - 后端：使用 Flask 开发服务器
   - 数据库：本地 MySQL 服务

2. **生产环境**：
   - 前端：构建静态文件，使用 Nginx 或 Apache 部署
   - 后端：使用 Gunicorn 或 uWSGI 部署 Flask 应用
   - 数据库：使用独立的 MySQL 服务器
   - 配置 HTTPS，确保数据传输安全

## 八、项目结构

```
VueFlaskProject/
├── vue_test1/          # 前端项目
│   ├── src/
│   │   ├── components/  # Vue 组件
│   │   ├── router/      # 路由配置
│   │   ├── stores/      # 状态管理
│   │   ├── utils/       # 工具函数
│   │   ├── App.vue      # 根组件
│   │   └── main.js      # 入口文件
│   └── package.json
├── flask_test1/         # 后端项目
│   ├── app/            # Flask 应用
│   │   ├── api/         # API 路由
│   │   ├── models/      # 数据库模型
│   │   ├── __init__.py  # 应用初始化
│   │   └── config.py    # 配置文件
│   ├── run.py           # 启动文件
│   └── requirements.txt # 依赖列表
└── docs/               # 技术文档
    ├── architecture.md
    ├── frontend.md
    ├── backend.md
    └── database.md
```